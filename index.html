<div class="control-group">
  <label for="colorColumn">Color Group:</label>
  <select id="colorColumn">
    <option>None</option>
  </select>
</div>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HoloGraph</title>
    <meta
      name="description"
      content="Enhanced 3D Data Visualization with Zoom and Labels"
    />
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-troika-text@^1.0.0/dist/aframe-troika-text.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://unpkg.com/aframe-line-component/dist/aframe-line-component.min.js"></script>
        <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="favicon_io/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="favicon_io/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="favicon_io/favicon-16x16.png"
    />
    <link rel="manifest" href="favicon_io/site.webmanifest" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="control-panel">
      <h3 class="sidebar-header">
        <img src="logo.png" alt="icon" class="sidebar-logo" />
        <span class="sidebar-title">HoloGraph</span>
      </h3>
      <div class="controller">
        <div class="file-input-container">
          <input type="file" id="csvInput" accept=".csv" class="file-input" />
          <button
            id="unloadButton"
            class="unload-button"
            onclick="unloadCSV()"
            style="display: none"
          >
            âœ•
          </button>
        </div>

        <div class="control-group">
          <label for="chartType">Chart Type:</label>
          <select id="chartType">
            <option value="function">Function Plot</option>
            <option value="bar">3D Bar Chart</option>
            <option value="scatter">3D Scatter Plot</option>
            <option value="line">3D Line Chart</option>
            <option value="pie">3D Pie Chart</option>
            <option value="surface">3D Surface Plot</option>
            <option value="network">3D Network Graph</option>
            <option value="heatmap">3D Heatmap</option>
          </select>
        </div>

        <div
          class="control-group"
          id="functionInputGroup"
          style="display: none; flex-direction: column; align-items: stretch"
        >
          <label for="functionInput" style="margin-bottom: 6px">
            f(x) or f(x,y) or equation(s):
            <span style="font-weight: normal; color: #888">(one per line)</span>
          </label>
          <textarea
            id="functionInput"
            rows="3"
            style="
              width: 100%;
              font-size: 13px;
              resize: vertical;
              margin-bottom: 10px;
            "
          >
sin(x^2 + y^2) - cos(x - y)</textarea
          >
          <div style="margin-top: 0">
            <label for="detailLevel" style="margin-bottom: 4px; display: block"
              >Detail Level:</label
            >
            <select id="detailLevel" style="width: 100%; margin-top: 2px">
              <option value="low">Low (Fast)</option>
              <option value="medium" selected>Medium (Balanced)</option>
              <option value="high">High (Slow)</option>
              <option value="ultra">Ultra High (Very Slow)</option>
            </select>
          </div>
        </div>

        <div class="control-group">
          <label for="xColumn">X Column:</label>
          <select id="xColumn">
            <option>Select X</option>
          </select>
        </div>

        <div class="control-group">
          <label for="yColumn">Y Column:</label>
          <select id="yColumn">
            <option>Select Y</option>
          </select>
        </div>

        <div class="control-group">
          <label for="zColumn">Z Column (Surface/Network):</label>
          <select id="zColumn">
            <option>None</option>
          </select>
        </div>

        <div class="control-group">
          <label for="sizeColumn">Size Column (Network):</label>
          <select id="sizeColumn">
            <option>None</option>
          </select>
        </div>

        <div class="control-group">
          <div
            style="
              display: flex;
              align-items: center;
              justify-content: space-between;
              margin-bottom: 6px;
            "
          >
            <label
              style="
                display: flex;
                align-items: center;
                gap: 4px;
                margin-bottom: 0;
              "
            >
              <input type="checkbox" id="showLabels" checked />Labels
            </label>
            <div style="display: flex; align-items: center; gap: 4px">
              <input
                type="range"
                id="labelFontSizeSlider"
                min="10"
                max="40"
                value="18"
                style="width: 100%"
              />
              <span
                id="labelFontSizeValue"
                style="
                  color: #a084e8;
                  font-size: 0.95em;
                  min-width: 24px;
                  text-align: right;
                "
                >18px</span
              >
            </div>
          </div>
          <div
            style="
              display: flex;
              align-items: center;
              justify-content: space-between;
              margin-bottom: 6px;
            "
          >
            <label
              style="
                display: flex;
                align-items: center;
                gap: 4px;
                margin-bottom: 0;
              "
            >
              <input type="checkbox" id="showValues" checked />Values
            </label>
            <div style="display: flex; align-items: center; gap: 4px">
              <input
                type="range"
                id="valueFontSizeSlider"
                min="10"
                max="40"
                value="16"
                style="width: 100%"
              />
              <span
                id="valueFontSizeValue"
                style="
                  color: #a084e8;
                  font-size: 0.95em;
                  min-width: 24px;
                  text-align: right;
                "
                >16px</span
              >
            </div>
          </div>
          <div
            style="
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 4px 12px;
              align-items: center;
            "
          >
            <label style="display: flex; align-items: center; gap: 4px">
              <input type="checkbox" id="showGridLines" checked />Grid
            </label>
            <label style="display: flex; align-items: center; gap: 4px">
              <input type="checkbox" id="showAxisLines" checked />Axis
            </label>
          </div>
        </div>

        <button class="button" onclick="generateChart()">Generate</button>
        <div class="loading" id="loading">Loading...</div>
        <div class="error" id="error"></div>
        <div class="stats" id="stats">Load CSV to see data</div>
      </div>
    </div>

    <!-- Hamburger/Close menu button -->
    <button id="hamburgerMenuBtn" aria-label="Open menu">&#9776;</button>
    <!-- Floating menu for view controls -->
    <div id="floatingViewMenu">
      <button class="view-button" onclick="setView('front')">Front View</button>
      <button class="view-button" onclick="setView('top')">Top View</button>
      <button class="view-button" onclick="setView('side')">Side View</button>
      <button class="view-button" onclick="setView('isometric')">
        Isometric View
      </button>
      <button class="view-button" onclick="setView('free')">Free View</button>
    </div>


    <div class="zoom-controls">
      <button
        class="zoom-button vr-button"
        onclick="toggleVRMode()"
        aria-label="Toggle VR Mode"
        title="Toggle VR Mode"
        style="display: flex; align-items: center; justify-content: center"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          width="1.4em"
          height="1.4em"
          style="display: block"
        >
          <path
            d="m8,10.5c0,.827-.673,1.5-1.5,1.5s-1.5-.673-1.5-1.5.673-1.5,1.5-1.5,1.5.673,1.5,1.5Zm9.5-1.5c-.827,0-1.5.673-1.5,1.5s.673,1.5,1.5,1.5,1.5-.673,1.5-1.5-.673-1.5-1.5-1.5Zm6.5-1v8c0,2.761-2.239,5-5,5h-1.215c-1.067,0-2.053-.566-2.591-1.487l-1.472-2.522c-.52-.895-1.378-.991-1.723-.991s-1.203.096-1.723.991l-1.471,2.521c-.538.922-1.524,1.488-2.591,1.488h-1.214c-2.761,0-5-2.239-5-5v-8C0,5.239,2.239,3,5,3h14c2.761,0,5,2.239,5,5Zm-14,2.5c0-1.93-1.57-3.5-3.5-3.5s-3.5,1.57-3.5,3.5,1.57,3.5,3.5,3.5,3.5-1.57,3.5-3.5Zm11,0c0-1.93-1.57-3.5-3.5-3.5s-3.5,1.57-3.5,3.5,1.57,3.5,3.5,3.5,3.5-1.57,3.5-3.5Z"
            fill="#fff"
          />
        </svg>
      </button>
      <button
        class="zoom-button"
        id="toggleCameraBgBtn"
        aria-label="Camera Background"
        title="Camera Background"
        style="display: flex; align-items: center; justify-content: center"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          width="1.4em"
          height="1.4em"
          style="display: block"
        >
          <path
            d="m7,24h-2c-2.757,0-5-2.243-5-5v-2c0-.553.447-1,1-1s1,.447,1,1v2c0,1.654,1.346,3,3,3h2c.553,0,1,.447,1,1s-.447,1-1,1Zm17-5v-2c0-.553-.447-1-1-1s-1,.447-1,1v2c0,1.654-1.346,3-3,3h-2c-.553,0-1,.447-1,1s.447,1,1,1h2c2.757,0,5-2.243,5-5Zm0-12v-2c0-2.757-2.243-5-5-5h-2c-.553,0-1,.447-1,1s.447,1,1,1h2c1.654,0,3,1.346,3,3v2c0,.553.447,1,1,1s1-.447,1-1Zm-22,0v-2c0-1.654,1.346-3,3-3h2c.553,0,1-.447,1-1s-.447-1-1-1h-2C2.243,0,0,2.243,0,5v2c0,.553.447,1,1,1s1-.447,1-1Zm16,3v4c0,1.654-1.346,3-3,3h-6c-1.654,0-3-1.346-3-3v-4c0-1.639,1.321-2.974,2.953-2.999l.696-1.083c.368-.574.997-.918,1.682-.918h1.338c.685,0,1.313.344,1.683.919l.695,1.082c1.633.025,2.953,1.36,2.953,2.999Zm-4,2c0-1.105-.895-2-2-2s-2,.895-2,2,.895,2,2,2,2-.895,2-2Z"
            fill="#fff"
          />
        </svg>
      </button>
      <button class="zoom-button" onclick="zoomIn()" aria-label="Zoom In" title="Zoom In" style="display: flex; align-items: center; justify-content: center;">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1.4em" height="1.4em" style="display: block;"><path d="M480,224H288V32c0-17.673-14.327-32-32-32s-32,14.327-32,32v192H32c-17.673,0-32,14.327-32,32s14.327,32,32,32h192v192c0,17.673,14.327,32,32,32s32-14.327,32-32V288h192c17.673,0,32-14.327,32-32S497.673,224,480,224z" fill="#fff"/></svg>
      </button>
      <button class="zoom-button" onclick="zoomOut()" aria-label="Zoom Out" title="Zoom Out" style="display: flex; align-items: center; justify-content: center;">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1.4em" height="1.4em" style="display: block;"><path d="M480,288H32c-17.673,0-32-14.327-32-32s14.327-32,32-32h448c17.673,0,32,14.327,32,32S497.673,288,480,288z" fill="#fff"/></svg>
      </button>
      <button class="zoom-button" onclick="resetView()" title="Reset">âŒ‚</button>
      <button
        class="zoom-button"
        id="rotateModeBtn"
        title="Rotate Mode"
        onclick="toggleRotateMode()"
        style="display: flex; align-items: center; justify-content: center"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          width="1.4em"
          height="1.4em"
          style="display: block"
        >
          <path
            d="m1,6V1h2v3.104C5.256,1.542,8.524,0,12,0c6.617,0,12,5.383,12,12h-2c0-5.514-4.486-10-10-10-3.154,0-6.115,1.51-7.991,4h3.991v2H3c-1.103,0-2-.897-2-2Zm20,10h-5v2h3.991c-1.877,2.49-4.837,4-7.991,4-5.514,0-10-4.486-10-10H0c0,6.617,5.383,12,12,12,3.476,0,6.744-1.542,9-4.104v3.104h2v-5c0-1.103-.897-2-2-2Z"
            fill="#fff"
          />
        </svg>
      </button>
      <button
        class="zoom-button"
        id="panModeBtn"
        title="Pan Mode"
        onclick="togglePanMode()"
        style="display: flex; align-items: center; justify-content: center"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          width="1.4em"
          height="1.4em"
          style="display: block"
        >
          <path
            d="m22.5,3c-.828,0-1.5.672-1.5,1.5v6.5c0,.552-.448,1-1,1h0c-.552,0-1-.448-1-1V2.5c0-.828-.672-1.5-1.5-1.5s-1.5.672-1.5,1.5v8.5c0,.552-.448,1-1,1h0c-.552,0-1-.448-1-1V1.5c0-.828-.672-1.5-1.5-1.5s-1.5.672-1.5,1.5v9.5c0,.552-.448,1-1,1h0c-.552,0-1-.448-1-1V3.58c0-.747-.511-1.44-1.248-1.56-.94-.153-1.752.568-1.752,1.479v12.654l-2.605-2.65c-.088-.088-.24-.201-.441-.333-.843-.47-1.954-.284-2.584.561-.604.81-.437,1.965.276,2.68l3.523,3.635c2.449,2.527,5.817,3.953,9.335,3.953h2.495c4.418,0,8-3.582,8-8V4.5c0-.828-.672-1.5-1.5-1.5Z"
            fill="#fff"
          />
        </svg>
      </button>
    </div>

    <a-scene id="scene" background="color: #1a1a2e" vr-mode-ui="enabled: false">
      <a-assets>
        <!-- No need for cameraVideoAsset -->
      </a-assets>
      <a-sky id="cameraSky" visible="false"></a-sky>
      <!-- Enhanced lighting -->
      <a-light type="ambient" color="#404040"></a-light>
      <a-light
        type="directional"
        position="5 5 5"
        color="#ffffff"
        intensity="0.8"
      ></a-light>
      <a-light
        type="point"
        position="0 5 0"
        color="#ffffff"
        intensity="0.3"
      ></a-light>

      <!-- Graph rotation container - this will rotate the entire graph around origin -->
      <a-entity id="graphRotationContainer" position="0 0 0">
        <!-- Data container -->
        <a-entity id="dataContainer"></a-entity>

        <!-- Labels container -->
        <a-entity id="labelsContainer"></a-entity>

        <!-- Enhanced axes with labels -->
        <a-entity id="axesContainer">
          <!-- X-axis -->
          <a-cylinder
            position="2 0 0"
            height="4"
            radius="0.02"
            rotation="0 0 90"
            material="color: #ff4757"
          ></a-cylinder>
          <a-entity
            id="xAxisLabel"
            text="value: X Axis; color: #ff4757; align: center; baseline: center; wrapCount: 12; shader: msdf"
            position="4.5 0 0"
            scale="0.8 0.8 0.8"
          ></a-entity>

          <!-- Y-axis -->
          <a-cylinder
            position="0 2 0"
            height="4"
            radius="0.02"
            material="color: #2ed573"
          ></a-cylinder>
          <a-entity
            id="yAxisLabel"
            text="value: Y Axis; color: #2ed573; align: center; baseline: center; wrapCount: 12; shader: msdf"
            position="0 4.5 0"
            scale="0.8 0.8 0.8"
          ></a-entity>

          <!-- Z-axis -->
          <a-cylinder
            position="0 0 2"
            height="4"
            radius="0.02"
            rotation="90 0 0"
            material="color: #3742fa"
          ></a-cylinder>
          <a-entity
            text="value: Z; color: #3742fa; align: center; baseline: center; wrapCount: 12; shader: msdf"
            position="0 0 4.5"
            scale="0.8 0.8 0.8"
          ></a-entity>

          <!-- Grid lines -->
          <a-entity id="gridLines"></a-entity>
          <!-- XZ Floor Grid -->
          <a-entity id="floorGrid"></a-entity>
        </a-entity>
      </a-entity>

      <!-- Camera with zoom controls -->
      <a-entity id="cameraRig" position="0 1.6 8">
        <a-camera
          id="camera"
          look-controls
          wasd-controls
          mouse-cursor="rayOrigin: mouse"
        >
          <a-cursor
            position="0 0 -1"
            geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
            material="color: #3498db; shader: flat"
          >
          </a-cursor>
        </a-camera>
      </a-entity>

      <!-- Enhanced Title -->
      <a-entity
        id="chartTitle"
        text="value: HoloGraph; color: #ffffff; align: center; baseline: center; wrapCount: 24; shader: msdf"
        position="0 3.5 -4"
        scale="1.5 1.5 1.5"
      ></a-entity>

      <!-- Legend container -->
      <a-entity id="legendContainer" position="-5 2 -2"></a-entity>
    </a-scene>

    <video id="cameraVideo" autoplay playsinline style="display: none"></video>

    <div class="sidebar-toggle-btn" id="sidebarToggleBtn" title="Hide sidebar">
      <svg
        id="sidebarToggleIcon"
        width="32"
        height="32"
        viewBox="0 0 32 32"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle cx="16" cy="16" r="16" fill="url(#sidebarBtnGradient)" />
        <defs>
          <linearGradient
            id="sidebarBtnGradient"
            x1="0"
            y1="0"
            x2="32"
            y2="32"
            gradientUnits="userSpaceOnUse"
          >
            <stop stop-color="#21e6c1" />
            <stop offset="1" stop-color="#2d8cf0" />
          </linearGradient>
        </defs>
        <polygon id="sidebarArrow" points="20,8 12,16 20,24" fill="#fff" />
      </svg>
    </div>

    <script src="script.js"></script>
  </body>
</html>
